# Squelch Security Suite - fail2ban Configuration
# This file provides comprehensive protection for web servers and SSH

[DEFAULT]
# Ban time: 1 hour initially, increases with repeat offenses
bantime = 1h
bantime.increment = true
bantime.multipliers = 1 2 4 8 16 32 64
bantime.maxtime = 168h

# Find time window: 10 minutes
findtime = 10m

# Max retry attempts before ban
maxretry = 5

# Default ban action using iptables
banaction = iptables-multiport
banaction_allports = iptables-allports

# Ignore local network from bans (adjust subnet as needed)
ignoreip = 127.0.0.1/8 ::1 192.168.0.0/24 10.0.0.0/8 172.16.0.0/12

[sshd]
enabled = true
port = ssh,2222
filter = sshd
backend = systemd
maxretry = 2
bantime = 24h
findtime = 5m

[squelch-caddy-auth]
enabled = true
port = http,https
filter = squelch-caddy-auth
logpath = /var/log/caddy/access.log
maxretry = 5

[squelch-caddy-badbots]
enabled = true
port = http,https
filter = squelch-caddy-badbots
logpath = /var/log/caddy/access.log
maxretry = 2

[squelch-caddy-scan]
enabled = true
port = http,https
filter = squelch-caddy-scan
logpath = /var/log/caddy/access.log
maxretry = 3

[squelch-nginx-auth]
enabled = false
port = http,https
filter = squelch-nginx-auth
logpath = /var/log/nginx/access.log
maxretry = 5

[squelch-apache-auth]
enabled = false
port = http,https
filter = squelch-apache-auth
logpath = /var/log/apache2/access.log
maxretry = 5